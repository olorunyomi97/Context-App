import React, { useState, useEffect, useRef } from "react";
import { Link, NavLink, useNavigate, useLocation } from "react-router-dom";
import { useSelector } from "react-redux";

//logo & icons
import onePortLogo from "assets/logos/oneport-logo.svg";
import onePortLogoWhite from "assets/logos/oneport-logowhite.svg";

import menuIcon from "assets/dock/menu-icon.svg";
import close from "assets/icons/close.svg";

import caretRight from "assets/dock/caret-right.svg";
import caretDown from "assets/dock/caret-down.svg";

//components
import Button from "./Button";
import CountrySwitch from "./CountrySwitch";

const ServiceItem = ({
  img,
  text,
  to,
  setShowNavServices,
  source,
  setToggleMenu,
}) => (
  <NavLink
    to={to}
    className="flex items-center gap-x-[10px] cursor-pointer service-type"
    onClick={(e) => {
      source === "desktop" ? setShowNavServices(false) : setToggleMenu(false);
      e.stopPropagation();
    }}
  >
    {({ isActive }) => (
      <>
        <div className={isActive ? "green-text" : "text-[#6b7280]"}>{img}</div>
        <p className={isActive ? "green-text" : "font-light text-[#6b7280]"}>
          {text}
        </p>
      </>
    )}
  </NavLink>
);

interface ServiceGroupProps {
  setShowNavServices?: () => React.Dispatch<React.SetStateAction<boolean>>;
  setToggleMenu?: React.Dispatch<React.SetStateAction<boolean>> | undefined;
  source: string;
}

const ServiceGroup = ({
  setShowNavServices,
  source,
  setToggleMenu,
}: ServiceGroupProps) => (
  <>
    <ServiceItem
      img={
        <svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path className="shipment-svg" fill-rule="evenodd" clip-rule="evenodd" d="M5.279 6.542c-.163.095-.154.18.128 1.26.147.565.26 1.043.248 1.061-.01.018-.097.044-.19.058-.354.053-.91.206-.972.267-.056.056-.065.263-.082 1.955l-.019 1.892-.21.077c-.823.299-1.594.614-1.634.667-.036.048-.048.373-.048 1.313v1.25l.102.08c.1.08.13.08 1.437.07 1.27-.01 1.337-.015 1.388-.085.085-.116.069-.312-.03-.382-.073-.05-.255-.06-1.224-.06H3.035v-1.859l.831-.308c5.086-1.889 10.613-3.332 15.875-4.147.349-.053.657-.098.684-.098.124 0-.063 1.19-.29 1.84-.288.827-.543 1.205-1.429 2.111-.948.97-1.458 1.629-1.74 2.242l-.1.22h-2.3c-2.554 0-2.473-.008-2.471.24.001.304-.086.294 2.629.294 2.352 0 2.407-.002 2.503-.077a.406.406 0 0 0 .125-.2c.053-.248.363-.783.7-1.212.278-.351.649-.76 1.21-1.335.802-.82 1.099-1.282 1.395-2.171.23-.695.343-1.356.343-2.017 0-.31-.01-.364-.081-.436-.072-.071-.11-.078-.316-.057-.394.042-1.943.289-2.89.461l-.898.164-1.346-.777a72.773 72.773 0 0 0-1.478-.84c-.124-.06-.192-.06-.986.002-.47.036-1.09.086-1.38.111l-.524.046-.036-.115c-.404-1.304-.461-1.458-.558-1.502-.067-.03-.416-.045-1.092-.045H8.42l-.094.094c-.051.051-.093.124-.092.162 0 .038.101.42.223.85.151.531.21.791.18.807a1.455 1.455 0 0 1-.29.05l-.248.024-.279-.927c-.197-.654-.302-.946-.358-.993-.07-.06-.182-.067-1.097-.066-.64 0-1.044.016-1.087.041Zm2.063 1.255.232.763-.12.02-.635.097a9.9 9.9 0 0 0-.563.093c-.027.01-.061-.04-.084-.125l-.227-.876-.19-.735H7.11l.232.763Zm3.038-.172c.1.314.178.574.173.579-.004.004-.305.04-.668.08l-.66.07-.073-.25c-.04-.137-.12-.412-.176-.612-.057-.2-.111-.384-.121-.41-.015-.04.123-.047.662-.039l.681.01.182.572Zm3.648.997c.134.075.245.148.245.162 0 .014-.443.1-.985.191-3.293.556-6.232 1.21-8.16 1.816l-.182.056V9.566l.488-.1c1.707-.356 3.704-.602 7.596-.937.699-.06.728-.057.998.094Zm1.495.863c.38.218.464.281.408.304-.04.016-.407.1-.817.186-2.28.481-5.115 1.233-7.61 2.017a83.86 83.86 0 0 0-2.49.825c-.063.025-.068-.023-.068-.696v-.723l.64-.196c1.944-.595 4.566-1.159 8.457-1.819.537-.091.981-.167.989-.17.007-.001.228.12.492.272Zm-.015 2.36a.257.257 0 0 0-.086.42c.178.178.508-.018.43-.254-.043-.127-.22-.212-.344-.165Zm-1.655.445a.255.255 0 0 0 .011.343c.155.154.447.036.447-.182a.255.255 0 0 0-.458-.16Zm-1.505.32c-.252.197.002.566.285.414.234-.124.115-.487-.161-.493a.461.461 0 0 0-.124.079Zm-5.45 3.456c-.104.132-.1.226.015.34.09.09.116.094.556.094.44 0 .467-.005.556-.094.118-.117.12-.25.005-.357-.08-.077-.128-.083-.57-.083-.476 0-.483.001-.562.1Zm2.644-.041c-.058.04-.085.098-.085.181.001.248.106.294.668.294.42 0 .448-.005.537-.094.118-.117.12-.25.006-.357-.081-.076-.129-.083-.565-.083-.37 0-.496.013-.561.059Z" fill="currentColor" />
          <path className="shipment-svg" clip-rule="evenodd" d="M5.279 6.542c-.163.095-.154.18.128 1.26.147.565.26 1.043.248 1.061-.01.018-.097.044-.19.058-.354.053-.91.206-.972.267-.056.056-.065.263-.082 1.955l-.019 1.892-.21.077c-.823.299-1.594.614-1.634.667-.036.048-.048.373-.048 1.313v1.25l.102.08c.1.08.13.08 1.437.07 1.27-.01 1.337-.015 1.388-.085.085-.116.069-.312-.03-.382-.073-.05-.255-.06-1.224-.06H3.035v-1.859l.831-.308c5.086-1.889 10.613-3.332 15.875-4.147.349-.053.657-.098.684-.098.124 0-.063 1.19-.29 1.84-.288.827-.543 1.205-1.429 2.111-.948.97-1.458 1.629-1.74 2.242l-.1.22h-2.3c-2.554 0-2.473-.008-2.471.24.001.304-.086.294 2.629.294 2.352 0 2.407-.002 2.503-.077a.406.406 0 0 0 .125-.2c.053-.248.363-.783.7-1.212.278-.351.649-.76 1.21-1.335.802-.82 1.099-1.282 1.395-2.171.23-.695.343-1.356.343-2.017 0-.31-.01-.364-.081-.436-.072-.071-.11-.078-.316-.057-.394.042-1.943.289-2.89.461l-.898.164-1.346-.777a72.773 72.773 0 0 0-1.478-.84c-.124-.06-.192-.06-.986.002-.47.036-1.09.086-1.38.111l-.524.046-.036-.115c-.404-1.304-.461-1.458-.558-1.502-.067-.03-.416-.045-1.092-.045H8.42l-.094.094c-.051.051-.093.124-.092.162 0 .038.101.42.223.85.151.531.21.791.18.807a1.455 1.455 0 0 1-.29.05l-.248.024-.279-.927c-.197-.654-.302-.946-.358-.993-.07-.06-.182-.067-1.097-.066-.64 0-1.044.016-1.087.041Zm2.063 1.255.232.763-.12.02-.635.097a9.9 9.9 0 0 0-.563.093c-.027.01-.061-.04-.084-.125l-.227-.876-.19-.735H7.11l.232.763Zm3.038-.172c.1.314.178.574.173.579-.004.004-.305.04-.668.08l-.66.07-.073-.25c-.04-.137-.12-.412-.176-.612-.057-.2-.111-.384-.121-.41-.015-.04.123-.047.662-.039l.681.01.182.572Zm3.648.997c.134.075.245.148.245.162 0 .014-.443.1-.985.191-3.293.556-6.232 1.21-8.16 1.816l-.182.056V9.566l.488-.1c1.707-.356 3.704-.602 7.596-.937.699-.06.728-.057.998.094Zm1.495.863c.38.218.464.281.408.304-.04.016-.407.1-.817.186-2.28.481-5.115 1.233-7.61 2.017a83.86 83.86 0 0 0-2.49.825c-.063.025-.068-.023-.068-.696v-.723l.64-.196c1.944-.595 4.566-1.159 8.457-1.819.537-.091.981-.167.989-.17.007-.001.228.12.492.272Zm-.015 2.36a.257.257 0 0 0-.086.42c.178.178.508-.018.43-.254-.043-.127-.22-.212-.344-.165Zm-1.655.445a.255.255 0 0 0 .011.343c.155.154.447.036.447-.182a.255.255 0 0 0-.458-.16Zm-1.505.32c-.252.197.002.566.285.414.234-.124.115-.487-.161-.493a.461.461 0 0 0-.124.079Zm-5.45 3.456c-.104.132-.1.226.015.34.09.09.116.094.556.094.44 0 .467-.005.556-.094.118-.117.12-.25.005-.357-.08-.077-.128-.083-.57-.083-.476 0-.483.001-.562.1Zm2.644-.041c-.058.04-.085.098-.085.181.001.248.106.294.668.294.42 0 .448-.005.537-.094.118-.117.12-.25.006-.357-.081-.076-.129-.083-.565-.083-.37 0-.496.013-.561.059Z" stroke="currentColor" stroke-width=".2" mask="url(#a)" />
        </svg>
      }
      text="Ocean Freight"
      to="/services/ocean-freight"
      setShowNavServices={setShowNavServices}
      setToggleMenu={setToggleMenu}
      source={source}
    />
    <ServiceItem
      img={
        <svg width="24" height="15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path className="shipment-svg" d="M17.641.027c-.308.044-.61.124-.899.24-.15.062-1.44.66-2.865 1.33-1.424.668-2.615 1.216-2.645 1.216-.03 0-1.383-.52-3.008-1.155C6.587 1.018 5.145.476 4.99.443c-.542-.115-1.062 0-1.33.297-.29.322-.465.917-.338 1.154.026.05.925.693 1.997 1.43 1.073.737 1.937 1.353 1.92 1.368-.06.057-2.122 1.012-2.186 1.012-.035 0-.897-.21-1.915-.47C2 4.947 1.25 4.775 1.194 4.79a.414.414 0 0 0-.17.108C.91 5.022 0 6.686 0 6.769c0 .04.026.121.057.182.062.12.077.127 1.925.884.521.214.947.4.947.414.001.013-.132.083-.296.155-.32.14-.445.26-.445.42 0 .128.788 1.822.905 1.946.053.056.13.091.203.091.074 0 1.245-.526 3.1-1.393 1.64-.767 2.987-1.386 2.995-1.377.007.009-.11 1.296-.26 2.86l-.274 2.845.078.105c.12.163.456.346.732.398.61.115 1.13-.208 1.465-.91.063-.134.651-1.83 1.306-3.772a405.828 405.828 0 0 1 1.205-3.54c.007-.005 1.078-.505 2.38-1.111 1.302-.606 2.48-1.167 2.617-1.247.138-.08.411-.303.606-.496.29-.287.385-.413.518-.684.37-.753.304-1.4-.198-1.937-.443-.474-1.126-.679-1.925-.576Zm.92.754c.213.06.492.254.603.422.33.498-.007 1.312-.75 1.82-.251.171-4.417 2.157-4.452 2.122-.009-.01.037-.163.102-.342.156-.428.156-.584-.001-.717-.224-.187-.458-.098-.575.22-.042.114-.703 2.075-1.47 4.36a375.438 375.438 0 0 1-1.468 4.322c-.117.276-.268.489-.403.571-.222.136-.59.073-.556-.095.009-.046.17-1.721.358-3.725l.343-3.643-.08-.105c-.165-.223-.481-.2-.583.043-.027.067-.072.37-.098.675l-.05.553-2.98 1.39c-1.64.764-2.995 1.389-3.013 1.388-.03-.001-.48-.944-.48-1.007 0-.018.239-.144.53-.28.545-.256.643-.34.643-.55 0-.182-.193-.284-1.768-.936C1.558 6.914.86 6.614.86 6.6c0-.033.535-.978.579-1.021.02-.02.804.155 1.862.415l1.828.45.258-.11c.142-.06 2.818-1.307 5.947-2.77C14.462 2.104 17.108.878 17.213.842c.395-.134.986-.16 1.348-.06ZM4.896 1.15c.243.056 5.418 2.059 5.418 2.096.001.029-2.217 1.066-2.279 1.066-.05 0-3.996-2.694-4.033-2.753-.044-.07.125-.327.26-.396.16-.081.33-.086.634-.013Z" fill="currentColor" />
        </svg>
      }
      text="Air Freight"
      to="/services/air-freight"
      setShowNavServices={setShowNavServices}
      setToggleMenu={setToggleMenu}
      source={source}
    />
    <ServiceItem
      img={
        <svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path className="shipment-svg" fill-rule="evenodd" clip-rule="evenodd" d="M3.734 5.553a.745.745 0 0 0-.372.416c-.058.203-.051 5.877.007 5.987.109.203.328.243.484.087l.096-.096V6.123H16.02v2.873c0 2.11.012 2.897.045 2.96.109.203.328.243.484.087.08-.081.096-.134.096-.332v-.236h1.924c1.168 0 1.98.015 2.065.04.198.054.38.186.53.383.21.275.203.28-.4.28-.51 0-.532.003-.625.095-.091.092-.096.12-.096.572 0 .602.042.744.292.994.227.228.398.292.777.292h.26v1.406h-.804l-.121-.244c-.722-1.457-2.82-1.457-3.542.001-.08.161-.142.242-.181.234-.052-.01-.062-.185-.08-1.27-.02-1.38-.015-1.351-.262-1.4-.105-.021-.144-.006-.244.093l-.118.12v2.466H9.539l-.081-.184c-.347-.782-1.222-1.264-2.078-1.143-.618.086-1.24.536-1.499 1.083l-.116.244-.898-.01-.898-.01v-.703l.75-.01.75-.01.08-.103c.105-.134.1-.258-.015-.392l-.094-.11H2.184l-.094.11c-.116.134-.12.258-.013.393l.08.103H3.325v.4c.002.305.019.438.073.557.168.366.307.406 1.393.408l.86.002.048.3c.262 1.648 2.306 2.26 3.424 1.025.223-.246.444-.695.475-.962.012-.103.03-.227.04-.275l.017-.088h7.014l.06.322c.08.42.226.722.488 1.005.427.461.832.638 1.46.638s1.033-.177 1.46-.638c.268-.29.406-.57.485-.99l.063-.331.562-.013.562-.012.096-.112.096-.112-.012-1.9c-.01-1.849-.013-1.906-.096-2.108-.193-.47-.634-.876-1.073-.989-.132-.033-.21-.078-.233-.13-.018-.044-.14-.506-.27-1.028l-.235-.95.122-.102.122-.103-.016-.413c-.014-.355-.03-.442-.123-.62-.126-.243-.354-.483-.561-.587-.276-.14-.525-.163-1.768-.163h-1.206l-.013-.46c-.011-.41-.023-.472-.107-.59a.746.746 0 0 0-.253-.204c-.154-.07-.395-.073-6.294-.072-5.038 0-6.154.01-6.25.053Zm15.594 1.986a.756.756 0 0 1 .351.475l.023.14h-3.057v-.707l1.28.012c1.13.01 1.293.02 1.403.08ZM11.09 9.94l-1.438 1.435-.752-.749c-.479-.477-.79-.758-.86-.775-.22-.053-.428.201-.34.414.024.058.444.503.933.99.81.804.902.884 1.022.884.123 0 .253-.12 1.725-1.593 1.45-1.45 1.593-1.604 1.593-1.72a.326.326 0 0 0-.319-.32c-.114 0-.266.139-1.564 1.434Zm8.594-.136c.134.543.244 1 .243 1.016 0 .016-.74.03-1.642.03h-1.64V8.817h2.794l.245.986Zm1.688 3.35v.352h-.25c-.216 0-.261-.014-.35-.103-.09-.09-.104-.135-.104-.352v-.248h.704v.351Zm-18.598-.198c-.14.14-.147.286-.018.415l.096.096H4.96c1.16 0 2.136-.011 2.171-.024.071-.028.178-.213.178-.31 0-.034-.052-.114-.115-.177l-.114-.114H2.888l-.114.114Zm7.437 1.253a.32.32 0 0 0-.188.35c.054.245-.05.236 2.663.236h2.469l.08-.103c.107-.135.103-.259-.013-.393l-.094-.11-2.415-.007c-1.352-.005-2.454.007-2.502.027Zm-2.258.645c.339.055.736.366.914.714.174.342.175.844.002 1.185-.517 1.018-1.928 1.02-2.428.004-.116-.235-.128-.295-.127-.594.001-.281.018-.367.109-.554.191-.396.59-.705 1-.775.178-.03.232-.028.53.02Zm10.939-.017c.6.111 1.06.593 1.134 1.19.05.404-.17.935-.491 1.19a1.353 1.353 0 0 1-2.17-.738c-.188-.74.324-1.514 1.086-1.64.113-.02.207-.037.208-.04.002-.002.106.015.233.038Zm-11.574.776c-.48.3-.371 1.012.18 1.177.312.094.712-.143.77-.456.085-.448-.15-.763-.587-.788-.186-.01-.263.004-.363.067Zm11.051-.01c-.387.191-.443.792-.099 1.063a.63.63 0 0 0 .86-.051.641.641 0 0 0 .06-.836c-.164-.229-.546-.31-.82-.176Z" fill="currentColor" />
          <path className="shipment-svg" clip-rule="evenodd" d="M3.734 5.553a.745.745 0 0 0-.372.416c-.058.203-.051 5.877.007 5.987.109.203.328.243.484.087l.096-.096V6.123H16.02v2.873c0 2.11.012 2.897.045 2.96.109.203.328.243.484.087.08-.081.096-.134.096-.332v-.236h1.924c1.168 0 1.98.015 2.065.04.198.054.38.186.53.383.21.275.203.28-.4.28-.51 0-.532.003-.625.095-.091.092-.096.12-.096.572 0 .602.042.744.292.994.227.228.398.292.777.292h.26v1.406h-.804l-.121-.244c-.722-1.457-2.82-1.457-3.542.001-.08.161-.142.242-.181.234-.052-.01-.062-.185-.08-1.27-.02-1.38-.015-1.351-.262-1.4-.105-.021-.144-.006-.244.093l-.118.12v2.466H9.539l-.081-.184c-.347-.782-1.222-1.264-2.078-1.143-.618.086-1.24.536-1.499 1.083l-.116.244-.898-.01-.898-.01v-.703l.75-.01.75-.01.08-.103c.105-.134.1-.258-.015-.392l-.094-.11H2.184l-.094.11c-.116.134-.12.258-.013.393l.08.103H3.325v.4c.002.305.019.438.073.557.168.366.307.406 1.393.408l.86.002.048.3c.262 1.648 2.306 2.26 3.424 1.025.223-.246.444-.695.475-.962.012-.103.03-.227.04-.275l.017-.088h7.014l.06.322c.08.42.226.722.488 1.005.427.461.832.638 1.46.638s1.033-.177 1.46-.638c.268-.29.406-.57.485-.99l.063-.331.562-.013.562-.012.096-.112.096-.112-.012-1.9c-.01-1.849-.013-1.906-.096-2.108-.193-.47-.634-.876-1.073-.989-.132-.033-.21-.078-.233-.13-.018-.044-.14-.506-.27-1.028l-.235-.95.122-.102.122-.103-.016-.413c-.014-.355-.03-.442-.123-.62-.126-.243-.354-.483-.561-.587-.276-.14-.525-.163-1.768-.163h-1.206l-.013-.46c-.011-.41-.023-.472-.107-.59a.746.746 0 0 0-.253-.204c-.154-.07-.395-.073-6.294-.072-5.038 0-6.154.01-6.25.053Zm15.594 1.986a.756.756 0 0 1 .351.475l.023.14h-3.057v-.707l1.28.012c1.13.01 1.293.02 1.403.08ZM11.09 9.94l-1.438 1.435-.752-.749c-.479-.477-.79-.758-.86-.775-.22-.053-.428.201-.34.414.024.058.444.503.933.99.81.804.902.884 1.022.884.123 0 .253-.12 1.725-1.593 1.45-1.45 1.593-1.604 1.593-1.72a.326.326 0 0 0-.319-.32c-.114 0-.266.139-1.564 1.434Zm8.594-.136c.134.543.244 1 .243 1.016 0 .016-.74.03-1.642.03h-1.64V8.817h2.794l.245.986Zm1.688 3.35v.352h-.25c-.216 0-.261-.014-.35-.103-.09-.09-.104-.135-.104-.352v-.248h.704v.351Zm-18.598-.198c-.14.14-.147.286-.018.415l.096.096H4.96c1.16 0 2.136-.011 2.171-.024.071-.028.178-.213.178-.31 0-.034-.052-.114-.115-.177l-.114-.114H2.888l-.114.114Zm7.437 1.253a.32.32 0 0 0-.188.35c.054.245-.05.236 2.663.236h2.469l.08-.103c.107-.135.103-.259-.013-.393l-.094-.11-2.415-.007c-1.352-.005-2.454.007-2.502.027Zm-2.258.645c.339.055.736.366.914.714.174.342.175.844.002 1.185-.517 1.018-1.928 1.02-2.428.004-.116-.235-.128-.295-.127-.594.001-.281.018-.367.109-.554.191-.396.59-.705 1-.775.178-.03.232-.028.53.02Zm10.939-.017c.6.111 1.06.593 1.134 1.19.05.404-.17.935-.491 1.19a1.353 1.353 0 0 1-2.17-.738c-.188-.74.324-1.514 1.086-1.64.113-.02.207-.037.208-.04.002-.002.106.015.233.038Zm-11.574.776c-.48.3-.371 1.012.18 1.177.312.094.712-.143.77-.456.085-.448-.15-.763-.587-.788-.186-.01-.263.004-.363.067Zm11.051-.01c-.387.191-.443.792-.099 1.063a.63.63 0 0 0 .86-.051.641.641 0 0 0 .06-.836c-.164-.229-.546-.31-.82-.176Z" stroke="currentColor" stroke-width=".1" mask="url(#a)" />
        </svg>
      }
      text="Inland Logistics"
      to="/services/inland-logistics"
      setShowNavServices={setShowNavServices}
      setToggleMenu={setToggleMenu}
      source={source}
    />
    <ServiceItem
      img={
        <svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path className="shipment-svg" fill-rule="evenodd" clip-rule="evenodd" d="M12.895 3.928c-.19.06-.48.361-.539.559a1.727 1.727 0 0 0-.047.399v.237l-1.455.012-1.456.011-.254.12a1.63 1.63 0 0 0-.758.76l-.12.253-.012 1.61-.011 1.61-2.372.012-2.371.01-.176.092c-.24.126-.455.338-.58.572l-.103.196v6.992l.104.195c.124.234.34.447.58.572l.175.092 2.374.011 2.373.011-.023.094c-.04.16.057.654.178.902.152.314.429.588.743.737l.253.12h10.82l.255-.12c.322-.153.6-.432.757-.758l.122-.254V6.279l-.12-.254a1.63 1.63 0 0 0-.76-.758l-.253-.12-1.455-.012-1.455-.012v-.262c-.002-.453-.25-.828-.622-.94-.203-.06-3.599-.054-3.793.007Zm.235.623c-.184.095-.198.18-.187 1.092.01.825.013.852.1.938l.088.089h3.355l.09-.09c.087-.087.088-.104.088-.984s-.002-.898-.089-.986l-.089-.089-1.63-.01c-1.258-.007-1.652.002-1.726.04ZM9.563 5.807a.923.923 0 0 0-.575.475l-.097.19-.012 1.515-.012 1.515h.939l.011-1.377c.015-1.862-.098-1.724 1.427-1.74l1.065-.012v-.621l-1.28.003c-.912.001-1.333.017-1.466.052Zm7.746.253v.313l1.064.012c1.192.013 1.185.011 1.355.31l.081.143-.01 5.834c-.01 5.709-.012 5.836-.086 5.934-.042.055-.12.134-.176.175-.097.075-.213.077-4.68.087-5.017.01-4.686.025-4.911-.216a.572.572 0 0 1-.124-.254l-.023-.146h-.94l.024.28c.043.505.31.84.74.929.144.03 1.726.04 5.304.032l5.099-.01.194-.1a.945.945 0 0 0 .483-.623c.06-.28.06-11.986 0-12.266a.945.945 0 0 0-.483-.623l-.194-.1-1.359-.012-1.358-.012v.313Zm-6.875 2.202v1.26l.173.07c.24.1.49.33.629.58l.116.209v6.992l-.09.168c-.14.262-.345.463-.604.592l-.237.119h8.763V7.002h-1.05c-.93 0-1.056.007-1.104.065a.957.957 0 0 1-.249.156l-.195.09H13.03l-.195-.09a.958.958 0 0 1-.249-.156c-.047-.058-.173-.065-1.104-.065h-1.05v1.26Zm7.041 1.093-.634.634-.246-.244c-.2-.198-.269-.243-.373-.243a.326.326 0 0 0-.32.32c0 .11.056.184.4.529.571.573.48.597 1.466-.39.707-.708.79-.805.79-.92a.326.326 0 0 0-.32-.32c-.114 0-.2.07-.763.634Zm-5.242.562a.405.405 0 0 0-.08.21c0 .059.036.153.08.21l.081.102h2.801l.081-.103a.405.405 0 0 0 .081-.21.405.405 0 0 0-.08-.209l-.082-.103h-2.8l-.082.103Zm-8.534.25c-.16.048-.369.263-.414.427-.052.187-.053 6.38 0 6.562.05.177.256.384.428.432.187.052 6.379.052 6.566 0 .172-.048.378-.255.429-.432.052-.181.051-6.375 0-6.562-.049-.172-.256-.378-.433-.429-.074-.02-.42-.038-.769-.038h-.635v.576c0 .524-.01.594-.093.772a.79.79 0 0 1-.454.446c-.164.074-.252.08-1.328.08-1.13 0-1.156-.002-1.35-.092a.911.911 0 0 1-.48-.529c-.025-.082-.045-.397-.045-.701v-.552l-.654.003c-.36.002-.706.019-.768.038Zm2.054.486c.018.76-.079.704 1.243.704s1.225.055 1.243-.704l.013-.526H5.74l.013.526Zm11.722 1.514-.634.634-.246-.243c-.2-.199-.269-.244-.373-.244a.326.326 0 0 0-.32.32c0 .11.056.184.4.53.571.572.48.597 1.466-.39.707-.709.79-.806.79-.92a.326.326 0 0 0-.32-.32c-.114 0-.2.07-.763.633Zm-5.242.563a.405.405 0 0 0-.08.21c0 .058.036.152.08.209l.081.103h2.801l.081-.103a.405.405 0 0 0 .081-.21.405.405 0 0 0-.08-.21l-.082-.102h-2.8l-.082.103Zm5.242 2.25-.634.634-.246-.244c-.2-.198-.269-.243-.373-.243a.326.326 0 0 0-.32.32c0 .11.056.184.4.529.571.573.48.597 1.466-.39.707-.708.79-.805.79-.92a.326.326 0 0 0-.32-.32c-.114 0-.2.07-.763.634Zm-13.523.25a.405.405 0 0 0-.08.21c0 .058.036.152.08.209l.081.103h2.176l.081-.103a.322.322 0 0 0 0-.42l-.08-.102H4.032l-.08.103Zm8.281.312a.405.405 0 0 0-.08.21c0 .059.036.153.08.21l.081.102h2.801l.081-.103a.405.405 0 0 0 .081-.21.405.405 0 0 0-.08-.209l-.082-.103h-2.8l-.082.103Zm-8.28.938a.405.405 0 0 0-.082.21c0 .058.037.152.081.209l.081.103H5.584l.081-.103a.322.322 0 0 0 0-.42l-.08-.102H4.032l-.08.103Z" fill="currentColor" />
        </svg>
      }
      text="Custom Brokerage"
      to="/services/custom-brokerage"
      setShowNavServices={setShowNavServices}
      setToggleMenu={setToggleMenu}
      source={source}
    />
  </>
);

const NavServices = ({ setShowNavServices, source }) => (
  <div className="w-60 bg-white rounded-[10px] px-8 py-8 flex flex-col gap-y-8 shadow-[0px_4px_21px_-4px_rgba(0,0,0,0.19)]">
    <ServiceGroup setShowNavServices={setShowNavServices} source={source} />
  </div>
);

const Navbar = ({ isNav }) => {
  const [toggleMenu, setToggleMenu] = useState<boolean>(false);
  const [showServices, setShowServices] = useState<boolean>(false);
  const [showNavServices, setShowNavServices] = useState<boolean>(false);
  const [source, setSource] = useState<string>("");
  const location = useLocation();

  const navigate = useNavigate();

  const ref = useRef<HTMLDivElement>(null);

  let user = useSelector((state: any) => state.auth.user_data);
  // @ts-ignore
  user = user ? user : localStorage.getItem("user_data");

  // console.log("user>>>", user)

  //creating the click outside to close drop down effect
  useEffect(() => {
    const checkIfClickedOutside = (e) => {
      // If the menu is open and the clicked target is not within the menu, then close the menu
      if (showNavServices && ref.current && !ref.current.contains(e.target)) {
        setShowNavServices(false);
      }
    };
    document.addEventListener("mousedown", checkIfClickedOutside);
    return () => {
      // Cleanup the event listener
      document.removeEventListener("mousedown", checkIfClickedOutside);
    };
  }, [showNavServices]);

  return (
    <div className={`${isNav ? "dock" : ""} bottom-divider relative z-30`}>
      <nav className={`max-w-[1200px] mx-auto flex items-center lg:justify-between px-6 py-7`}>
        <Link to="/"><img src={location.pathname === "/" ? onePortLogoWhite : onePortLogo} alt="" /></Link>
        {/* <!-- Menu Items --> */}
        <div className="hidden space-x-6 lg:flex">
          <NavLink to="/about" className="text-sm grey-text font-normal">
            {({ isActive }) => (
              <>
                <span className={isActive ? "green-text" : `text-sm ${location.pathname === "/" ? "text-white" : "grey-text"} font-normal`}>About Us</span>
              </>
            )}
          </NavLink>
          <Link
            to="#"
            className={`text-sm font-normal relative ${location.pathname.includes("/services") ? "green-text" : `${location.pathname === "/" ? "text-white" : "grey-text"}`}`}
            onClick={() => {
              setShowNavServices(true);
              setSource("desktop");
            }}
          >
            Services
            {showNavServices && (
              <div ref={ref} className="absolute top-8 z-10">
                <NavServices
                  setShowNavServices={setShowNavServices}
                  source={source}
                />
              </div>
            )}
          </Link>
          <NavLink to="/contact" className="text-sm grey-text font-normal">
            {({ isActive }) => (
              <>
                <span className={isActive ? "green-text" : `text-sm ${location.pathname === "/" ? "text-white" : "grey-text"} font-normal`}>Contact Us</span>
              </>
            )}
          </NavLink>
          <NavLink to="https://oneport365.teamtailor.com/" target="_blank" rel="noopener noreferrer"  className="text-sm grey-text font-normal">
            {({ isActive }) => (
              <>
                <span className={isActive ? "green-text" : `text-sm ${location.pathname === "/" ? "text-white" : "grey-text"} font-normal`}>Careers</span>
              </>
            )}
          </NavLink>
        </div>
        <div className="ml-auto lg:ml-0 flex items-center">
          <Link to="/signin" className={`text-sm ${location.pathname === "/" ? "text-white" : "text-[#005D00]"} font-medium hidden lg:inline`}>{user ? "Dashboard" : "Login"}</Link>
          <Link to="/signup" className="text-sm bg-[#3AB44A] text-white py-3 px-6 rounded hidden sm:inline lg:ml-10 mr-4 lg:mr-0 order-[-2] lg:order-none">Create Account</Link>
          <div className="bg-[#98ff9b33] ml-5 mr-[20px] lg:mr-0 w-[1px] h-10 rounded-sm" />
          <div className="lg:ml-5 lg:order-none order-[-1]"><CountrySwitch /></div>
          {/* <div className="flex items-center">
            <div className="flex items-center right-divider ml-auto">
              <img
                src={`https://ui-avatars.com/api/?background=3ab44a&color=ffffff&name=${user?.firstname}+${user?.lastname}`}
                alt="user initial"
                className="rounded-full w-10"
              />
              <div className="flex items-center gap-x-2">
                <p className="text-sm grey-text-3 ml-2">
                  {user?.firstname?.charAt(0).toUpperCase() + user?.firstname?.slice(1)}{" "}
                  {user?.lastname?.charAt(0).toUpperCase() + user?.lastname?.slice(1)}
                </p>
                <img src={caretDown} alt="caret" className="pr-5" />
              </div>
            </div>
            <div className="pl-5 pr-11">
              <svg
                width="24"
                height="25"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  clip-rule="evenodd"
                  d="M12 18.848c5.64 0 8.248-.724 8.5-3.627 0-2.902-1.819-2.716-1.819-6.276C18.681 6.165 16.045 3 12 3S5.319 6.164 5.319 8.945c0 3.56-1.819 3.374-1.819 6.275.253 2.915 2.862 3.628 8.5 3.628Z"
                  stroke="#667085"
                  stroke-width="1.3"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M14.389 21.855c-1.364 1.515-3.492 1.533-4.87 0"
                  stroke="#667085"
                  stroke-width="1.3"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <circle cx="18" cy="4" r="3.5" fill="#D92D20" stroke="#fff" />
              </svg>
            </div>
          </div> */}
        </div>
        <div className="block lg:hidden">
          <div className="cursor-pointer" onClick={() => setToggleMenu(true)}><img src={menuIcon} alt="menu" /></div>
          {toggleMenu && (
            <div className="fixed top-0 left-0 w-full flex justify-center h-full bg-[#0618028c] z-[50]">
              <div className="flex flex-col bg-white rounded-lg w-full mx-4 md:w-[434px] md:mx-0 max-h-[calc(100vh_-_50px)] overflow-auto my-5">
                <div className="pl-4 pr-5 pt-7 pb-8 flex justify-between items-center border-b-[1px] border-solid border-[#eaecf080]">
                  <Link to="/" onClick={() => setToggleMenu(false)}><img src={onePortLogo} alt="" /></Link>
                  <div
                    className="cursor-pointer"
                    onClick={() => setToggleMenu(false)}
                  >
                    <img src={close} alt="" />
                  </div>
                </div>
                <div className="px-4 pt-6">
                  <div>
                    <NavLink
                      to="/about"
                      className={({ isActive }) =>
                        isActive
                          ? `bg-[#d7f7cc4d] font-normal block py-5 px-4 rounded`
                          : "text-base grey-text font-normal block py-5 px-4 rounded"
                      }
                      onClick={() => setToggleMenu(false)}
                    >
                      {({ isActive }) => (
                        <>
                          <span
                            className={
                              isActive
                                ? "green-text font-medium"
                                : "grey-text font-normal"
                            }
                          >
                            About Oneport
                          </span>
                        </>
                      )}
                    </NavLink>
                    <div onClick={() => setSource("mobile")}>
                      <Link
                        to="#"
                        className={`text-base grey-text font-normal py-5 px-4 rounded flex items-center justify-between ${
                          showServices ? "bg-[#e9e9e933]" : ""
                        }`}
                        onClick={() => setShowServices(!showServices)}
                      >
                        <span>Our Services</span>
                        <img
                          src={showServices ? caretDown : caretRight}
                          alt=""
                        />
                      </Link>
                      {showServices && (
                        <div className="px-4 flex flex-col gap-y-9 bg-[#e9e9e933] py-[18px]">
                          <ServiceGroup
                            source={source}
                            setToggleMenu={setToggleMenu}
                          />
                        </div>
                      )}
                    </div>
                    <NavLink
                      to="/contact"
                      className={({ isActive }) =>
                        isActive
                          ? `bg-[#d7f7cc4d] font-normal block py-5 px-4 rounded`
                          : "text-base grey-text font-normal block py-5 px-4 rounded"
                      }
                      onClick={() => setToggleMenu(false)}
                    >
                      {({ isActive }) => (
                        <>
                          <span
                            className={
                              isActive
                                ? "green-text font-medium"
                                : "grey-text font-normal"
                            }
                          >
                            Contact Us
                          </span>
                        </>
                      )}
                    </NavLink>
                    <NavLink
                      to="https://oneport365.teamtailor.com/" target="_blank" rel="noopener noreferrer"
                      className={({ isActive }) =>
                        isActive
                          ? `bg-[#d7f7cc4d] font-normal block py-5 px-4 rounded`
                          : "text-base grey-text font-normal block py-5 px-4 rounded"
                      }
                      onClick={() => setToggleMenu(false)}
                    >
                      {({ isActive }) => (
                        <>
                          <span
                            className={
                              isActive
                                ? "green-text font-medium"
                                : "grey-text font-normal"
                            }
                          >
                            Careers
                          </span>
                        </>
                      )}
                    </NavLink>
                  </div>
                </div>
                <div className="mt-auto flex flex-col gap-y-4 px-4 pb-8">
                  <Link
                    to="/signin"
                    className="text-sm text-[#005D00] py-3 px-6 text-center rounded font-medium bg-[#F6FEF4] breakdown-border"
                  >
                    {user ? "Dashboard" : "Login"}
                  </Link>
                  <Button
                    title="Create Account"
                    onClick={() => navigate("/signup")}
                  />
                </div>
              </div>
            </div>
          )}
        </div>
      </nav>
    </div>
  );
};

export default Navbar;
